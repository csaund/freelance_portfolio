---
title: "ploty_testing"
author: "Saund"
date: "20/05/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(plotly)
```

Their original code
```{r original code, eval=FALSE}
fig <- w.ws[j:k]%>%plot_ly(x=~Date,type='candlestick',open=~us10y.Open,high=~us10y.High,low=~us10y.Low,close=~us10y.Settle)
figs <- us10y.p$cwc$f.d5.w[j:k]%>%plot_ly(x=w.ws[j:k,Date],y=~us10y.f.d5.suw,type='scatter',mode='lines+markers')
figp <- us10y.p$cwc$f.d5.w[j:k]%>%plot_ly(x=w.ws[j:k,Date],y=~us10y.f.d5.prw,type='scatter',mode='lines+markers')
figs10 <- us10y.p$cwc$f.d10.w[j:k]%>%plot_ly(x=w.ws[j:k,Date],y=~us10y.f.d10.suw,type='scatter',mode='lines+markers')
figp10 <- us10y.p$cwc$f.d10.w[j:k]%>%plot_ly(x=w.ws[j:k,Date],y=~us10y.f.d10.prw,type='scatter',mode='lines+markers')
figf <- subplot(fig,figs,figp,figs10,figp10,nrows=5,shareX=TRUE)%>%layout(xaxis=list(rangeslider=list(visible=F)))

l <- list(
type='line',x0='2020-04-24', 
x1 = '2020-05-18',
y0=0.579,
y1=0.739,
xref='x',yref='y',
line=list(color='green',width=0.5))

layout(figf,shapes=l)%>%
config(edits = list(shapePosition = TRUE))
```


load data 
```{r loading}
  load('w.ws.RData')
  j <- 3
  k <- 10000

  
  #output$info <- renderText({
  #  paste0("x=", input$plot_click$x, "\ny=", input$plot_click$y)
  #})
  
  fig <- w.ws[j:k] %>%
    plot_ly(x=~Date,
            type='candlestick',
            open=~Open,
            high=~High,
            low=~Low,
            close=~Settle)
  figs <- us10y.p$cwc$f.d5.w[j:k] %>%
    plot_ly(x=w.ws[j:k,Date],
            y=~us10y.f.d5.suw,
            type='scatter',
            mode='lines+markers')
  figp <- us10y.p$cwc$f.d5.w[j:k]  %>%
    plot_ly(x=w.ws[j:k,Date],
            y=~us10y.f.d5.prw,
            type='scatter',
            mode='lines+markers')
  figs10 <- us10y.p$cwc$f.d10.w[j:k]  %>%
    plot_ly(x=w.ws[j:k,Date],
            y=~us10y.f.d10.suw,
            type='scatter',
            mode='lines+markers')
  figp10 <- us10y.p$cwc$f.d10.w[j:k]  %>%
    plot_ly(x=w.ws[j:k,Date],
            y=~us10y.f.d10.prw,type='scatter',
            mode='lines+markers')
  figf <- subplot(fig,figs,figp,figs10,figp10,
                  nrows=5,
                  shareX=TRUE) %>%
          layout(xaxis=list(rangeslider=list(visible=F)))

  l <- list(
    type='line',
    x0='2020-04-24', 
    x1 = '2020-05-18',
    y0=0.579,
    y1=0.739,
    xref='x',
    yref='y',
    line=list(color='green',width=0.5))

layout(figf,shapes=l)%>%
config(edits = list(shapePosition = TRUE))
```
